/* empty css             */import{E as ge,v as we}from"./el-divider-aa7ff13b.js";import{f as ve}from"./el-overlay-05fceefa.js";import{E as ye,a as he}from"./el-descriptions-item-60aef862.js";import{E as be}from"./el-card-9257071c.js";import{E as Ce,a as xe}from"./el-form-item-bc01fbf3.js";import{E as Ve,a as Ue}from"./el-input-34966377.js";import{f as Ee,g as Se}from"./el-select-55423668.js";import"./el-icon-7cd9012c.js";import{aF as I,aG as De,aO as ke,d as qe,r as U,a as T,O as Re,a6 as E,c as N,e as Ie,Z,i as a,A as $,w as r,h as n,f as e,j as o,D as y,ay as J,E as p,C as Be,p as Te,k as Ne,_ as Ae}from"./index-d68b52c9.js";import{b as Fe,a as G}from"./index-b36a6823.js";import{u as Pe}from"./setting-6a339329.js";const je=c=>I.post("/admin/create_user",c),Le=c=>I.post("/admin/ban_user",c),Oe=c=>I.post("/admin/query_user",c),Qe=c=>I.post("/admin/activate_user",c),ze=c=>I.post("/admin/renew_user",c);let Ze=De("admin",()=>({userCreate:async _=>{try{const i=ke(_.password).toString();return _.password=i,await je(_)}catch(i){return Promise.reject(i)}},userBan:async _=>{try{return await Le(_)}catch(i){return Promise.reject(i)}},userQuery:async _=>{try{return await Oe(_)}catch(i){return Promise.reject(i)}},userActivate:async _=>{try{return await Qe(_)}catch(i){return Promise.reject(i)}},userRenew:async _=>{try{return await ze(_)}catch(i){return Promise.reject(i)}}}));const $e=Ze,q=c=>(Te("data-v-5a7863ac"),c=c(),Ne(),c),Ge=q(()=>n("div",{class:"card-header"},"新建用户",-1)),He={class:"card-footer"},Je=q(()=>n("span",{style:{"margin-left":"12px",color:"dimgray"}},"使用管理权限新建用户",-1)),Ke=q(()=>n("div",{class:"card-header"},"用户操作",-1)),Me={class:"card-footer"},We=q(()=>n("span",{style:{"margin-left":"12px",color:"dimgray"}},"对用户进行查询、封禁、激活以及解封",-1)),Xe={class:"userinfo-cell-item"},Ye={class:"userinfo-cell-item"},er={class:"userinfo-cell-item"},rr={class:"userinfo-cell-item"},tr={class:"userinfo-cell-item"},sr={class:"userinfo-cell-item"},ar={class:"userinfo-cell-item"},lr=q(()=>n("div",{class:"card-header"},"用户续期",-1)),or={class:"card-footer"},nr=q(()=>n("span",{style:{"margin-left":"12px",color:"dimgray"}},"输入正整数，以小时为单位，1个月算作30天",-1)),ir={style:{"margin-right":"12px"}},ur={class:"dialog-footer"},mr=qe({__name:"index",setup(c){let A=Pe(),S=$e(),D=U(null),u=T({username:"",password:"",repassword:"",permission:"1"}),_=()=>{u.username="",u.password="",u.repassword="",u.permission="1";try{setTimeout(()=>{D.value&&D.value.clearValidate(["username","password","repassword","permission"])},200)}catch(s){console.log(s)}},i=(s,t,f)=>{/^[a-zA-Z0-9]+$/.test(t)?f():f(new Error("用户名只能是大小英文以及数字"))};const M={username:[{required:!0,message:"请输入用户名",trigger:"blur"},{min:5,max:12,message:"用户名长度为5到12位",trigger:"blur"},{validator:i,trigger:"blur"}],password:[{required:!0,message:"请输入密码",trigger:"blur"}],repassword:[{required:!0,message:"请确认密码",trigger:"blur"},{validator:(s,t,f)=>{t!==u.password?f(new Error("输入的密码不相同")):f()},trigger:"blur"}],permission:[{required:!0,message:"请选择权限",trigger:"blur"}]};let F=U(!1),W=async()=>{D.value&&await D.value.validate();try{F.value=!0;let s={username:"",password:"",permission:1};s.username=u.username,s.password=u.password,s.permission=Number(u.permission);let t=await S.userCreate(s);t.success?(p({type:"success",message:t.message,duration:3e3}),_()):p({type:"error",message:t.message,duration:3e3})}catch(s){p({type:"error",message:s.message,duration:3e3})}finally{F.value=!1}},b=U(!1),C=U(null),x=T({username:""});const X={username:[{required:!0,message:"请输入用户名",trigger:"blur"},{min:5,max:12,message:"用户名长度为5到12位",trigger:"blur"},{validator:i,trigger:"blur"}]};let l=T({ID:"未获取",username:"未获取",permission:"未获取",expire_at:"未获取",game_id:"未获取",create_at:"未获取",update_at:"未获取"}),Y=s=>{l.ID=s.ID.toString(),l.username=s.username,s.permission==0?l.permission="封禁(0)":s.permission==1?l.permission="游客(1)":s.permission==2?l.permission="普通用户(2)":s.permission==3?l.permission="开发者(3)":l.permission="未知(?)";let t=G(s.expire_at.toString()),f=G(s.create_at.toString()),m=G(s.update_at.toString());l.expire_at=t,l.create_at=f,l.update_at=m,s.game_id==0?l.game_id="暂未获取":l.game_id=s.game_id.toString()},ee=()=>{l.ID="未获取",l.username="未获取",l.permission="未获取",l.expire_at="未获取"},P=async()=>{C.value&&await C.value.validate();try{b.value=!0;let s={username:""};s.username=x.username;let t=await S.userQuery(s);t.success?(p({type:"success",message:t.message,duration:3e3}),Y(t.user)):(p({type:"error",message:t.message,duration:3e3}),ee())}catch(s){p({type:"error",message:s.message,duration:3e3})}finally{b.value=!1}},re=async()=>{C.value&&await C.value.validate();try{b.value=!0;let s={username:""};s.username=x.username;let t=await S.userActivate(s);t.success?(p({type:"success",message:t.message,duration:3e3}),P()):p({type:"error",message:t.message,duration:3e3})}catch(s){p({type:"error",message:s.message,duration:3e3})}finally{b.value=!1}},v=U(!1),te=async()=>{C.value&&await C.value.validate(),v.value=!0},se=async()=>{v.value=!1;try{b.value=!0;let s={username:""};s.username=x.username;let t=await S.userBan(s);t.success?(p({type:"success",message:t.message,duration:3e3}),P()):p({type:"error",message:t.message,duration:3e3})}catch(s){p({type:"error",message:s.message,duration:3e3})}finally{b.value=!1}},R=U(null),w=T({username:"",renew_time:""}),ae=Re(()=>Fe(w.renew_time)),le=()=>{w.username="",w.renew_time="";try{setTimeout(()=>{R.value&&R.value.clearValidate(["username","renew_time"])},200)}catch(s){console.log(s)}};const oe={username:[{required:!0,message:"请输入用户名",trigger:"blur"},{min:5,max:12,message:"用户名长度为5到12位",trigger:"blur"},{validator:i,trigger:"blur"}],renew_time:[{required:!0,message:"请输入续期时长",trigger:"blur"},{validator:(s,t,f)=>{const m=parseInt(t,10);isNaN(m)||m<=0||m!==parseFloat(t)?f(new Error("请输入正整数")):f()},trigger:"blur"}]};let j=U(!1),ne=async()=>{R.value&&await R.value.validate();try{j.value=!0;let s={username:"",renew_time:0};s.username=w.username,s.renew_time=Number(w.renew_time)*3600;let t=await S.userRenew(s);t.success?(p({type:"success",message:t.message,duration:3e3}),le()):p({type:"error",message:t.message,duration:3e3})}catch(s){p({type:"error",message:s.message,duration:3e3})}finally{j.value=!1}};return(s,t)=>{const f=E("ChatDotRound"),m=Be,L=ge,k=Ve,g=Ce,B=Ee,ie=Se,h=Ue,O=xe,Q=be,H=E("UserFilled"),V=ye,ue=E("Coordinate"),me=E("Tools"),de=E("Connection"),ce=E("SwitchButton"),pe=E("Refresh"),_e=he,fe=ve,z=we;return N(),Ie("div",null,[Z((N(),$(Q,{shadow:"hover"},{header:r(()=>[Ge]),default:r(()=>[n("div",null,[n("div",He,[e(m,null,{default:r(()=>[e(f)]),_:1}),Je]),e(L),e(O,{class:"admin-create-form-container",model:a(u),rules:M,ref_key:"createform",ref:D},{default:r(()=>[e(g,{prop:"username"},{default:r(()=>[e(k,{"prefix-icon":"User",modelValue:a(u).username,"onUpdate:modelValue":t[0]||(t[0]=d=>a(u).username=d),placeholder:"请输入用户名"},null,8,["modelValue"])]),_:1}),e(g,{prop:"password"},{default:r(()=>[e(k,{"prefix-icon":"Lock",type:"password","show-password":"",modelValue:a(u).password,"onUpdate:modelValue":t[1]||(t[1]=d=>a(u).password=d),placeholder:"请输入密码"},null,8,["modelValue"])]),_:1}),e(g,{prop:"repassword"},{default:r(()=>[e(k,{"prefix-icon":"Lock",type:"password","show-password":"",modelValue:a(u).repassword,"onUpdate:modelValue":t[2]||(t[2]=d=>a(u).repassword=d),placeholder:"请确认密码"},null,8,["modelValue"])]),_:1}),e(g,{prop:"permission"},{default:r(()=>[e(ie,{modelValue:a(u).permission,"onUpdate:modelValue":t[3]||(t[3]=d=>a(u).permission=d),class:"m-2",placeholder:"游客"},{default:r(()=>[e(B,{label:"封禁",value:"0"}),e(B,{label:"游客",value:"1"}),e(B,{label:"普通用户",value:"2"}),e(B,{label:"开发者",value:"3"})]),_:1},8,["modelValue"])]),_:1}),e(g,{style:{"margin-bottom":"0"}},{default:r(()=>[e(h,{type:"primary",onClick:a(W)},{default:r(()=>[o("新建")]),_:1},8,["onClick"]),e(h,{onClick:a(_)},{default:r(()=>[o("清空表单")]),_:1},8,["onClick"])]),_:1})]),_:1},8,["model"])])]),_:1})),[[z,a(F)]]),Z((N(),$(Q,{shadow:"hover",style:{"margin-top":"12px"}},{header:r(()=>[Ke]),default:r(()=>[n("div",null,[n("div",Me,[e(m,null,{default:r(()=>[e(f)]),_:1}),We]),e(L),e(O,{class:"admin-option-form-container",model:a(x),rules:X,ref_key:"optionform",ref:C},{default:r(()=>[e(g,{style:{"max-width":"400px"},label:"用户名",prop:"username"},{default:r(()=>[e(k,{modelValue:a(x).username,"onUpdate:modelValue":t[4]||(t[4]=d=>a(x).username=d),placeholder:"请输入用户名"},null,8,["modelValue"])]),_:1}),e(g,null,{default:r(()=>[e(_e,{style:{width:"100%"},class:"margin-top",direction:a(A).infoDirection,column:a(A).infoCol,size:"default",border:""},{default:r(()=>[e(V,null,{label:r(()=>[n("div",Xe,[e(m,{class:"userinfo-cell-item-icon"},{default:r(()=>[e(H)]),_:1}),o(" 用户 ID ")])]),default:r(()=>[o(" "+y(a(l).ID),1)]),_:1}),e(V,null,{label:r(()=>[n("div",Ye,[e(m,{class:"userinfo-cell-item-icon"},{default:r(()=>[e(H)]),_:1}),o(" 用户名称 ")])]),default:r(()=>[o(" "+y(a(l).username),1)]),_:1}),e(V,null,{label:r(()=>[n("div",er,[e(m,{class:"userinfo-cell-item-icon"},{default:r(()=>[e(ue)]),_:1}),o(" 游戏 ID ")])]),default:r(()=>[o(" "+y(a(l).game_id),1)]),_:1}),e(V,null,{label:r(()=>[n("div",rr,[e(m,{class:"userinfo-cell-item-icon"},{default:r(()=>[e(me)]),_:1}),o(" 用户权限 ")])]),default:r(()=>[o(" "+y(a(l).permission),1)]),_:1}),e(V,null,{label:r(()=>[n("div",tr,[e(m,{class:"userinfo-cell-item-icon"},{default:r(()=>[e(de)]),_:1}),o(" 创建时间 ")])]),default:r(()=>[o(" "+y(a(l).create_at),1)]),_:1}),e(V,null,{label:r(()=>[n("div",sr,[e(m,{class:"userinfo-cell-item-icon"},{default:r(()=>[e(ce)]),_:1}),o(" 有效期至 ")])]),default:r(()=>[o(" "+y(a(l).expire_at),1)]),_:1}),e(V,null,{label:r(()=>[n("div",ar,[e(m,{class:"userinfo-cell-item-icon"},{default:r(()=>[e(pe)]),_:1}),o(" 更新时间 ")])]),default:r(()=>[o(" "+y(a(l).update_at),1)]),_:1})]),_:1},8,["direction","column"])]),_:1}),e(g,{style:{"margin-bottom":"0"}},{default:r(()=>[e(h,{type:"primary",onClick:a(P)},{default:r(()=>[o("查询")]),_:1},8,["onClick"]),e(h,{type:"success",onClick:a(re)},{default:r(()=>[o("激活")]),_:1},8,["onClick"]),e(h,{type:"danger",onClick:a(te)},{default:r(()=>[o("封禁")]),_:1},8,["onClick"])]),_:1})]),_:1},8,["model"])])]),_:1})),[[z,a(b)]]),Z((N(),$(Q,{shadow:"hover",style:{"margin-top":"12px"}},{header:r(()=>[lr]),default:r(()=>[n("div",null,[n("div",or,[e(m,null,{default:r(()=>[e(f)]),_:1}),nr]),e(L),e(O,{class:"admin-renew-form-container",model:a(w),rules:oe,ref_key:"renewform",ref:R},{default:r(()=>[e(g,{label:"用户名称",prop:"username"},{default:r(()=>[e(k,{modelValue:a(w).username,"onUpdate:modelValue":t[5]||(t[5]=d=>a(w).username=d),placeholder:"请输入用户名"},null,8,["modelValue"])]),_:1}),e(g,{label:"续期时长",prop:"renew_time"},{default:r(()=>[e(k,{modelValue:a(w).renew_time,"onUpdate:modelValue":t[6]||(t[6]=d=>a(w).renew_time=d),type:"number",placeholder:"请输入正整数"},null,8,["modelValue"])]),_:1}),e(g,{style:{"margin-bottom":"0"}},{default:r(()=>[n("span",ir,y(a(ae)),1),e(h,{type:"primary",onClick:a(ne)},{default:r(()=>[o("续期")]),_:1},8,["onClick"])]),_:1})]),_:1},8,["model"])])]),_:1})),[[z,a(j)]]),e(fe,{width:"300px",modelValue:a(v),"onUpdate:modelValue":t[8]||(t[8]=d=>J(v)?v.value=d:v=d),title:"封禁","align-center":""},{footer:r(()=>[n("span",ur,[e(h,{onClick:t[7]||(t[7]=d=>J(v)?v.value=!1:v=!1)},{default:r(()=>[o("取消")]),_:1}),e(h,{type:"primary",onClick:a(se)},{default:r(()=>[o("确定")]),_:1},8,["onClick"])])]),default:r(()=>[o(" 确定封禁 "+y(a(x).username)+" 吗？ ",1)]),_:1},8,["modelValue"])])}}});const Vr=Ae(mr,[["__scopeId","data-v-5a7863ac"]]);export{Vr as default};
