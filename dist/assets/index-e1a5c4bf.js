/* empty css             */import{E as Z,a as z}from"./el-col-8a9e137f.js";import{E as G,a as P}from"./el-form-item-bc01fbf3.js";import{E as W,a as H}from"./el-input-34966377.js";import{d as J,u as O,r as k,a as F,o as Q,b as X,c as Y,e as ee,f as r,w as a,g as re,E as y,h as _,i as t,j as V,p as oe,k as te,_ as le}from"./index-d68b52c9.js";import{g as ae}from"./index-b36a6823.js";const C=h=>(oe("data-v-1eedd0af"),h=h(),te(),h),se={class:"login-container"},ne=C(()=>_("button",{class:"g-recaptcha","data-sitekey":"6LdATh8pAAAAAI8oKdlrCK9nt1FG1MTdSuE2ZhI5","data-callback":"robotCallback","data-expired-callback":"robotExpiredCallback","data-error-callback":"robotErrorCallback",hidden:""}," click ",-1)),ue={class:"login-form"},ie=C(()=>_("h1",null,"Welcome",-1)),de=C(()=>_("h2",null,"验证您的账号密码以登录到用户中心",-1)),ce={class:"input-container"},pe=C(()=>_("h2",null,"创建一个新的账户来使用我们的服务",-1)),me={class:"input-container"},ge=J({__name:"index",setup(h){let u=O(),N=re(),I=(i,e,o)=>{/^[a-zA-Z0-9]+$/.test(e)?o():o(new Error("用户名只能是大小英文以及数字"))},D=(i,e,o)=>{e!==s.password?o(new Error("输入的密码不相同")):o()};const R={username:[{required:!0,message:"请输入用户名",trigger:"blur"},{min:5,max:12,message:"用户名长度为5到12位",trigger:"blur"},{validator:I,trigger:"blur"}],password:[{required:!0,message:"请输入密码",trigger:"blur"}]},B={username:[{required:!0,message:"请输入用户名",trigger:"blur"},{min:5,max:12,message:"用户名长度为5到12位",trigger:"blur"},{validator:I,trigger:"blur"}],password:[{required:!0,message:"请输入密码",trigger:"blur"}],repassword:[{required:!0,message:"请确认密码",trigger:"blur"},{validator:D,trigger:"blur"}]};let g=k(null),f=k(null),w=k("login"),c=F({username:"",password:""}),s=F({username:"",password:"",repassword:""}),T=()=>{s.username="",s.password="",s.repassword="",c.username="",c.password=""},S=i=>{i=="reg"?(w.value="reg",g.value&&g.value.clearValidate(["username","password"]),f.value&&f.value.clearValidate(["username","password","repassword"]),document.querySelector(".login-form").style.height="344px",document.querySelector(".login-loginpage").style.left="-100%",document.querySelector(".login-regpage").style.left="32px",T()):i=="login"&&(w.value="login",g.value&&g.value.clearValidate(["username","password"]),f.value&&f.value.clearValidate(["username","password","repassword"]),document.querySelector(".login-form").style.height="294px",document.querySelector(".login-loginpage").style.left="32px",document.querySelector(".login-regpage").style.left="100%",T())},q=k(!1),L=k(!1);var $=async i=>{if(u.robotToken=i,w.value=="login"){if(u.robotToken)try{q.value=!0;let e={username:"",password:"",captcha_token:u.robotToken};e.username=c.username,e.password=c.password;let o=await u.userRegLog(e,w.value);if(o.success){N.push("/");let n=ae();y({type:"success",title:n,message:"登录成功",duration:3e3})}else y({type:"error",message:o.message,duration:3e3})}catch(e){y({type:"error",message:e.message,duration:3e3})}finally{q.value=!1}}else if(w.value=="reg"&&u.robotToken)try{L.value=!0;let e={username:"",password:"",captcha_token:u.robotToken};e.username=s.username,e.password=s.password;let o=await u.userRegLog(e,w.value);o.success?(S("login"),y({type:"success",message:"注册成功",duration:3e3})):y({type:"error",message:o.message,duration:3e3})}catch(e){y({type:"error",message:e.message,duration:3e3})}finally{L.value=!1}},j=()=>{console.log("验证过期"),u.robotToken=""},K=()=>{console.log("验证失败"),u.robotToken=""};let A=async()=>{g.value&&await g.value.validate(),u.robotToken="",grecaptcha.reset(),document.querySelector(".g-recaptcha").click()},U=async()=>{f.value&&await f.value.validate(),u.robotToken="",grecaptcha.reset(),document.querySelector(".g-recaptcha").click()},M=async()=>{try{await u.getToken()}catch{y({type:"error",message:"获取token失败",duration:3e3})}};return Q(()=>{const i=document.createElement("script");i.src="https://recaptcha.net/recaptcha/api.js",i.async=!0,document.head.appendChild(i),window.robotCallback=$,window.robotExpiredCallback=j,window.robotErrorCallback=K;let e=document.querySelector(".up-input").children[0].children[1],o=document.querySelector(".down-input").children[0].children[1],n=document.querySelector(".top-input").children[0].children[1],d=document.querySelector(".center-input").children[0].children[1],p=document.querySelector(".bottom-input").children[0].children[1],v=!1,b=!1,l=!1,E=!1,x=!1;e.addEventListener("focus",()=>{v=!0}),e.addEventListener("blur",()=>{v=!1}),o.addEventListener("focus",()=>{b=!0}),o.addEventListener("blur",()=>{b=!1}),n.addEventListener("focus",()=>{l=!0}),n.addEventListener("blur",()=>{l=!1}),d.addEventListener("focus",()=>{E=!0}),d.addEventListener("blur",()=>{E=!1}),p.addEventListener("focus",()=>{x=!0}),p.addEventListener("blur",()=>{x=!1}),document.querySelector(".login-loginpage").addEventListener("keyup",function(m){(m.key=="ArrowDown"||m.key=="ArrowUp")&&v==!0?o.focus():(m.key=="ArrowDown"||m.key=="ArrowUp")&&b==!0?e.focus():m.key=="Enter"&&w.value=="login"&&A()}),document.querySelector(".login-regpage").addEventListener("keyup",function(m){m.key=="ArrowDown"?l==!0?d.focus():E==!0?p.focus():x==!0&&n.focus():m.key=="ArrowUp"?l==!0?p.focus():E==!0?n.focus():x==!0&&d.focus():m.key=="Enter"&&w.value=="reg"&&U()}),e.focus(),g.value.clearValidate(["username","password"]),f.value.clearValidate(["username","password","repassword"]),M()}),X(()=>{window.robotCallback=null,window.robotExpiredCallback=null,window.robotErrorCallback=null}),(i,e)=>{const o=z,n=W,d=G,p=H,v=P,b=Z;return Y(),ee("div",se,[r(b,null,{default:a(()=>[r(o,{span:12,xs:0,sm:4,md:8,lg:12,style:{height:"100vh"}}),r(o,{span:12,xs:24,sm:20,md:16,lg:12,style:{height:"100vh",position:"relative"}},{default:a(()=>[ne,_("div",ue,[ie,r(v,{model:t(c),rules:R,ref_key:"loginform",ref:g,class:"login-page login-loginpage"},{default:a(()=>[de,_("div",ce,[r(d,{prop:"username"},{default:a(()=>[r(n,{class:"up-input",modelValue:t(c).username,"onUpdate:modelValue":e[0]||(e[0]=l=>t(c).username=l),"prefix-icon":"User",placeholder:"请输入用户名"},null,8,["modelValue"])]),_:1}),r(d,{prop:"password"},{default:a(()=>[r(n,{class:"down-input",modelValue:t(c).password,"onUpdate:modelValue":e[1]||(e[1]=l=>t(c).password=l),type:"password",placeholder:"请输入密码","show-password":"","prefix-icon":"Lock"},null,8,["modelValue"])]),_:1}),r(d,null,{default:a(()=>[r(p,{type:"primary",class:"login-btn",onClick:t(A),loading:t(q)},{default:a(()=>[V("登录")]),_:1},8,["onClick","loading"]),r(p,{type:"primary",class:"login-reg",onClick:e[2]||(e[2]=l=>t(S)("reg"))},{default:a(()=>[V("注册")]),_:1})]),_:1})])]),_:1},8,["model"]),r(v,{model:t(s),rules:B,ref_key:"regform",ref:f,class:"login-page login-regpage"},{default:a(()=>[pe,_("div",me,[r(d,{prop:"username"},{default:a(()=>[r(n,{class:"top-input",modelValue:t(s).username,"onUpdate:modelValue":e[3]||(e[3]=l=>t(s).username=l),"prefix-icon":"User",placeholder:"请输入用户名"},null,8,["modelValue"])]),_:1}),r(d,{prop:"password"},{default:a(()=>[r(n,{class:"center-input",modelValue:t(s).password,"onUpdate:modelValue":e[4]||(e[4]=l=>t(s).password=l),type:"password",placeholder:"请输入密码","show-password":"","prefix-icon":"Lock"},null,8,["modelValue"])]),_:1}),r(d,{prop:"repassword"},{default:a(()=>[r(n,{class:"bottom-input",modelValue:t(s).repassword,"onUpdate:modelValue":e[5]||(e[5]=l=>t(s).repassword=l),type:"password",placeholder:"请确认密码","show-password":"","prefix-icon":"Lock"},null,8,["modelValue"])]),_:1}),r(d,null,{default:a(()=>[r(p,{type:"primary",class:"login-btn",onClick:t(U),loading:t(L)},{default:a(()=>[V("注册")]),_:1},8,["onClick","loading"]),r(p,{type:"primary",class:"login-reg",onClick:e[6]||(e[6]=l=>t(S)("login"))},{default:a(()=>[V("登录")]),_:1})]),_:1})])]),_:1},8,["model"])])]),_:1})]),_:1})])}}});const ke=le(ge,[["__scopeId","data-v-1eedd0af"]]);export{ke as default};
